<Window x:Class="DepoEnvanterApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Depo Yönetim Sistemi" 
        Icon="envanter.ico"
        WindowState="Maximized" 
        WindowStartupLocation="CenterScreen"
        Background="#F0F2F5"
        DataContext="{Binding RelativeSource={RelativeSource Self}}">

    <Window.Resources>
        <Style x:Key="MenuButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="20,15"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="5" Margin="5,2">
                            <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#34495E"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ActionIconButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid x:Name="MainRoot" PreviewMouseDown="MainRoot_PreviewMouseDown">
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="SidebarColumn" Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="80"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Grid.ColumnSpan="2" Background="White" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
            <Grid Margin="20,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button x:Name="btnMenuToggle" Content="✕" FontSize="24" Background="Transparent" BorderThickness="0" Cursor="Hand" Click="BtnMenu_Toggle_Click" Margin="0,0,10,0"/>
                    <Image Source="envanter.ico" Width="40" Height="40" Margin="5,0,10,0"/>
                    <TextBlock Text="DEPO YÖNETİM" FontSize="18" FontWeight="Bold" Foreground="#2C3E50" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Border CornerRadius="20" Background="#F1F3F4" Padding="15,8" Width="400">
                        <DockPanel>
                            <TextBlock Text="🔍" VerticalAlignment="Center" Margin="0,0,10,0" Foreground="#5F6368"/>
                            <TextBox x:Name="txtArama" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center" TextChanged="TxtArama_TextChanged"/>
                        </DockPanel>
                    </Border>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="#F8F9FA" CornerRadius="18" Padding="12,6" BorderBrush="#DEE2E6" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="👤" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="#5F6368"/>
                            <TextBlock x:Name="lblAktifKullanici" Text="aksa" FontWeight="Bold" VerticalAlignment="Center" Foreground="#2C3E50"/>
                        </StackPanel>
                    </Border>
                    <Button Content="Oturumu Kapat" Click="BtnLogout_Click" Margin="15,0,0,0" Background="#E74C3C" Foreground="White" Padding="15,8" BorderThickness="0" Cursor="Hand" FontWeight="SemiBold"/>
                </StackPanel>
            </Grid>
        </Border>

        <Border x:Name="Sidebar" Grid.Row="1" Background="#1C2631">
            <StackPanel Margin="10">
                <Button x:Name="btnUrunler" Style="{StaticResource MenuButtonStyle}" Content="📦 Ürünler" Tag="Urunler" Click="BtnSayfaDegistir_Click"/>
                <Button x:Name="btnStok" Style="{StaticResource MenuButtonStyle}" Content="🔄 Stok İşlemleri" Tag="Stok" Click="BtnSayfaDegistir_Click" Background="#34495E"/>
            </StackPanel>
        </Border>

        <Grid Grid.Row="1" Grid.Column="1">

            <Grid x:Name="StokIslemleriGrid" Margin="25" Visibility="Visible">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Background="White" CornerRadius="12" Padding="20" Margin="0,0,0,25" BorderBrush="#DEE2E6" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Ürün Kayıt Formu" FontSize="16" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,15"/>
                        <WrapPanel>
                            <StackPanel Margin="5">
                                <TextBlock Text="Ürün Adı" FontSize="11" Foreground="#666" Margin="0,0,0,3"/>
                                <TextBox x:Name="txtUrunAdi" Width="150" Height="35" VerticalContentAlignment="Center" Padding="5,0"/>
                            </StackPanel>
                            <StackPanel Margin="5">
                                <TextBlock Text="Stok" FontSize="11" Foreground="#666" Margin="0,0,0,3"/>
                                <TextBox x:Name="txtStok" Width="70" Height="35" VerticalContentAlignment="Center" Padding="5,0" PreviewTextInput="TxtStok_PreviewTextInput"/>
                            </StackPanel>
                            <StackPanel Margin="5">
                                <TextBlock Text="Fiyat (Kuruş için . kullan)" FontSize="11" Foreground="#666" Margin="0,0,0,3"/>
                                <TextBox x:Name="txtFiyat" Width="80" Height="35" VerticalContentAlignment="Center" Padding="5,0" Language="en-US" PreviewTextInput="TxtFiyat_PreviewTextInput"/>
                            </StackPanel>
                            <StackPanel Margin="5">
                                <TextBlock Text="Barkod" FontSize="11" Foreground="#666" Margin="0,0,0,3"/>
                                <TextBox x:Name="txtBarkod" Width="110" Height="35" VerticalContentAlignment="Center" Padding="5,0"/>
                            </StackPanel>
                            <StackPanel Margin="5">
                                <TextBlock Text="Kategori" FontSize="11" Foreground="#666" Margin="0,0,0,3"/>
                                <ComboBox x:Name="cmbKategori" Width="120" Height="35" VerticalContentAlignment="Center" SelectedValuePath="Content">
                                    <ComboBoxItem Content="☕ Çay ve Kahve Ürünleri"/>
                                    <ComboBoxItem Content="🍳 Mutfak Ürünleri"/>
                                    <ComboBoxItem Content="🥣 Cam Ürünler"/>
                                    <ComboBoxItem Content="🍰 Servis ve Sunum"/>
                                    <ComboBoxItem Content="🏺 Dekoratif Ürünler"/>
                                    <ComboBoxItem Content="🧼 Temizlik ve Düzen"/>
                                    <ComboBoxItem Content="🎁 Set Ürünler"/>
                                    <ComboBoxItem Content="Diğer" IsSelected="True"/>
                                </ComboBox>
                            </StackPanel>
                            <Button Content="📁 Resim" Click="BtnResimSec_Click" Width="80" Height="35" Margin="5,19,5,0" Cursor="Hand"/>
                            <Button Content="➕ ÜRÜNÜ KAYDET" Click="BtnEkle_Click" Width="150" Height="40" Margin="10,14,0,0" Background="#27AE60" Foreground="White" FontWeight="Bold" BorderThickness="0" Cursor="Hand"/>
                        </WrapPanel>
                    </StackPanel>
                </Border>

                <Border Grid.Row="1" Background="White" CornerRadius="12" Padding="5" BorderBrush="#DEE2E6" BorderThickness="1">
                    <DataGrid x:Name="dgUrunler" ItemsSource="{Binding UrunlerListesi}" AutoGenerateColumns="False" CanUserAddRows="False" 
                              BeginningEdit="dgUrunler_BeginningEdit" RowHeight="85" IsReadOnly="False" Background="White" 
                              BorderThickness="0" GridLinesVisibility="None" SelectionMode="Single" 
                              HeadersVisibility="Column" HorizontalScrollBarVisibility="Disabled" ColumnWidth="*">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="GÖRSEL" Width="Auto" MinWidth="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Width="65" Height="65" CornerRadius="8" Background="#F8F9FA" BorderBrush="#EEE" BorderThickness="1" HorizontalAlignment="Center">
                                            <Button Click="BtnSatirResimDegistir_Click" Background="Transparent" BorderThickness="0" IsEnabled="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsEditing}">
                                                <Image Source="{Binding ResimYolu}" Stretch="Uniform" Margin="5"/>
                                            </Button>
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="ÜRÜN ADI" Width="1.5*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding UrunAdi}" VerticalAlignment="Center" Margin="15,0" FontWeight="SemiBold" FontSize="14" Foreground="#2C3E50"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                                <DataGridTemplateColumn.CellEditingTemplate>
                                    <DataTemplate>
                                        <TextBox Text="{Binding UrunAdi, UpdateSourceTrigger=PropertyChanged}" VerticalContentAlignment="Center" Margin="5"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellEditingTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="KATEGORİ" Width="1*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Kategori}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="#5F6368"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                                <DataGridTemplateColumn.CellEditingTemplate>
                                    <DataTemplate>
                                        <ComboBox SelectedValue="{Binding Kategori, UpdateSourceTrigger=PropertyChanged}" SelectedValuePath="Content" VerticalContentAlignment="Center" Margin="5">
                                            <ComboBoxItem Content="☕ Çay ve Kahve Ürünleri"/>
                                            <ComboBoxItem Content="🍳 Mutfak Ürünleri"/>
                                            <ComboBoxItem Content="🥣 Cam Ürünler"/>
                                            <ComboBoxItem Content="🍰 Servis ve Sunum"/>
                                            <ComboBoxItem Content="🏺 Dekoratif Ürünler"/>
                                            <ComboBoxItem Content="🧼 Temizlik ve Düzen"/>
                                            <ComboBoxItem Content="🎁 Set Ürünler"/>
                                            <ComboBoxItem Content="Diğer"/>
                                        </ComboBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellEditingTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="FİYAT" Width="0.8*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Fiyat, StringFormat={}{0:N2} ₺}" VerticalAlignment="Center" HorizontalAlignment="Center" FontWeight="Bold" Foreground="#2980B9"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                                <DataGridTemplateColumn.CellEditingTemplate>
                                    <DataTemplate>
                                        <TextBox Text="{Binding Fiyat, UpdateSourceTrigger=LostFocus, ConverterCulture='en-US'}" 
                                                 Language="en-US" 
                                                 VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Margin="5" 
                                                 PreviewTextInput="TxtFiyat_PreviewTextInput"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellEditingTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="STOK" Width="0.6*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding StokAdedi}" VerticalAlignment="Center" HorizontalAlignment="Center" FontWeight="Bold" FontSize="15" Foreground="Green"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                                <DataGridTemplateColumn.CellEditingTemplate>
                                    <DataTemplate>
                                        <TextBox Text="{Binding StokAdedi, UpdateSourceTrigger=PropertyChanged}" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Margin="5" PreviewTextInput="TxtStok_PreviewTextInput"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellEditingTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="BARKOD" Width="1*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Barkod}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="#7F8C8D"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                                <DataGridTemplateColumn.CellEditingTemplate>
                                    <DataTemplate>
                                        <TextBox Text="{Binding Barkod, UpdateSourceTrigger=PropertyChanged}" VerticalContentAlignment="Center" Margin="5"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellEditingTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="İŞLEMLER" Width="Auto" MinWidth="130">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button x:Name="btnDuzenle" Click="BtnSatirDuzenle_Click" Width="35" Height="35" Margin="3" Background="#3498DB" Style="{StaticResource ActionIconButtonStyle}">
                                                <TextBlock Text="✏️" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Button>
                                            <Button x:Name="btnKaydet" Click="BtnSatirKaydet_Click" Width="35" Height="35" Margin="3" Background="#27AE60" Style="{StaticResource ActionIconButtonStyle}" Visibility="Collapsed">
                                                <TextBlock Text="💾" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Button>
                                            <Button Click="BtnSil_Click" Width="35" Height="35" Margin="3" Background="#E74C3C" Style="{StaticResource ActionIconButtonStyle}">
                                                <TextBlock Text="🗑️" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Button>
                                        </StackPanel>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsEditing}" Value="True">
                                                <Setter TargetName="btnDuzenle" Property="Visibility" Value="Collapsed"/>
                                                <Setter TargetName="btnKaydet" Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>

            <Grid x:Name="UrunlerSayfasiGrid" Margin="25" Visibility="Collapsed">
                <Border Background="White" CornerRadius="12" Padding="15" BorderBrush="#DEE2E6" BorderThickness="1">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0" Text="Genel Ürün Listesi" FontSize="18" FontWeight="Bold" Foreground="#2C3E50" Margin="10,5,0,20"/>
                        <DataGrid Grid.Row="1" x:Name="dgGenelUrunler" ItemsSource="{Binding UrunlerListesi}" AutoGenerateColumns="False" IsReadOnly="True" 
                                  RowHeight="80" SelectionMode="Single" HeadersVisibility="Column" ColumnWidth="*">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="RESİM" Width="90">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Width="60" Height="60" CornerRadius="8" Background="#F8F9FA" BorderBrush="#EEEEEE" BorderThickness="1">
                                                <Image Source="{Binding ResimYolu}" Stretch="Uniform" Margin="5"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="ÜRÜN ADI" Width="1.5*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding UrunAdi}" VerticalAlignment="Center" FontWeight="SemiBold" FontSize="14"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="KATEGORİ" Width="1*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Kategori}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="FİYAT" Width="1*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Fiyat, StringFormat={}{0:N2} ₺}" VerticalAlignment="Center" HorizontalAlignment="Center" FontWeight="Bold" Foreground="#2980B9"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="STOK" Width="0.8*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding StokAdedi}" VerticalAlignment="Center" HorizontalAlignment="Center" FontWeight="Bold" Foreground="#27AE60"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="BARKOD" Width="1*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Barkod}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="#7F8C8D"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Window>